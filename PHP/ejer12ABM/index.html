<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lista</title>
    <link rel="stylesheet" href="./estilo.css">
</head>

<body>
    <div class="contenedor">
        <div class="cabezera">
            <header>
                <h3>Articulos</h3>
            </header>

            <div class="botones">
                <div class="entrada">
                    <p>Orden</p>
                    <input type="text" class="im" value="SaldoStock" readonly>
                </div>

                <div>
                    <button id="cargar-articulos" onclick="cargaTabla()" class="btn">Cargar Datos</button>
                </div>
                <div>
                    <button id="limpiar-articulos" class="btn">Vaciar Datos</button>
                </div>

                <div>
                    <button id="mostrar" onclick=mi_funcion() class="btn">Alta Registro</button>
                </div>

                <div>
                    <button id="alta" id="mostrar" class="btn">Cerrar Sesion</button>
                </div>

            </div>

        </div>

        <section>
            <table id="tabla-articulos">
                <thead>

                    <tr>
                        <th data-campo='id' scope="col">Numero de Documento<br>
                            <input type="text" class="filtro" id="numero_documento">
                        </th>
                        <th data-campo='id' scope="col">Tipo de Documento<br>
                            <input type="text" class="filtro" id="tipo_Documento">
                        </th>
                        <th data-campo='nom' scope="col">Nombre<br>
                            <input type="text" class="filtro" id="nombre">
                        </th>
                        <th data-campo='ape' scope="col">Apellidos<br>
                            <input type="text" class="filtro" id="apellido">
                        </th>
                        <th data-campo='fechaNac' scope="col">Fecha de Nacimiento<br>
                            <input type="text" class="filtro" id="fechaNac">
                        </th>
                        <th data-campo='mail' scope="col">Email</th>

                        <th data-campo='Pdf'>Imagen</th>
                        <th data-campo='modi'>MODIS</th>
                        <th data-campo='baja'>BAJAS</th>

                    </tr>


                </thead>

                <tbody id="tbody-articulos"></tbody>

                <tfoot>
                    <tr>
                        <th campo-dato='Sck'>$Email</th>
                    </tr>
                </tfoot>

            </table>
        </section>


        <footer>
            <div id="totalRegistros"></div>
            <h3>Pie</h3>
        </footer>

    </div>


    <div id="contenedor-modal" class="modal" style="display: none;">


        <header class="titulo">
            <h1>Encabezado modal Formulario de alta</h1>
            <span class="close-btn">
                <button id="ocultar" class="close">X</button>
                </span>

        </header>

        <div class="formulario">

            <form id="form" action="" class="form1">
                <div class="contenedor1">
                    <div class="hijo">
                        <p>Numero de Documento:</p>
                        <br>
                        <input type="text" id="codArt" name="codArt" class="inputFields" required title="complete este campo">
                        <br>
                        <br>
                    </div>
                    <div class="hijo">
                        <p>Nombre:</p>
                        <br>
                        <input type="text" id="descripcion" name="descripcion" class="inputFields" required title="complete este campo">
                        <br>
                        <br>
                    </div>

                    <div class="hijo">
                        <p>Apellido:</p>
                        <br>
                        <input type="number" id="saldoStock" name="saldoStock" class="inputFields" required title="complete este campo">
                        <br>
                        <br>
                    </div>
                </div>


                <div class="contenedor2">
                    <div class="hijo">
                        <p>Tipo de Documento:</p>
                        <br>
                        <select name="article-select" id="articulo-select" class="inputFields1"></select>
                        <br>
                        <br>
                    </div>

                    <div class="hijo">

                        <p>Fecha de Nacimiento:</p>
                        <br>
                        <input type="date" id="FechaAlta" name="FechaAlta" class="inputFields" required title="complete este campo">
                        <br>
                        <br>
                    </div>
                    <div class="hijo">
                        <p>Email:</p>
                        <br>
                        <input type="number" id="saldoStock" name="saldoStock" class="inputFields" required title="complete este campo">
                        <br>
                        <br>
                    </div>
                    <div class="hijo">
                        <p>Archivo:</p>
                        <br>
                        <input type="file" id="archivo" name="archivo" required title="complete este campo">
                        <br>
                        <br>
                    </div>



                </div>
                <div class="boton">
                    <button class="join-btn " id="button">ENVIAR ALTA</button>
                </div>

            </form>

        </div>

    </div>

    <div id="content-modal" class="modal" style="display: none;">


        <header class="titulo">
            <h1>Encabezado modal Formulario de modificacion</h1>
            <span class="close-btn">
                <button id="ocultar" class="close">X</button>
                </span>

        </header>

        <div class="formulario">

            <form id="form" action="" class="form1">
                <div class="contenedor1">
                    <div class="hijo">
                        <p>Numero de Documento:</p>
                        <br>
                        <input type="text" id="codArt" name="codArt" class="inputFields" required title="complete este campo">
                        <br>
                        <br>
                    </div>
                    <div class="hijo">
                        <p>Nombre:</p>
                        <br>
                        <input type="text" id="descripcion" name="descripcion" class="inputFields" required title="complete este campo">
                        <br>
                        <br>
                    </div>

                    <div class="hijo">
                        <p>Apellido:</p>
                        <br>
                        <input type="number" id="saldoStock" name="saldoStock" class="inputFields" required title="complete este campo">
                        <br>
                        <br>
                    </div>
                </div>


                <div class="contenedor2">
                    <div class="hijo">
                        <p>Tipo de Documento:</p>
                        <br>
                        <select name="article-select" id="articulo-select" class="inputFields1"></select>
                        <br>
                        <br>
                    </div>

                    <div class="hijo">

                        <p>Fecha de Nacimiento:</p>
                        <br>
                        <input type="date" id="FechaAlta" name="FechaAlta" class="inputFields" required title="complete este campo">
                        <br>
                        <br>
                    </div>
                    <div class="hijo">
                        <p>Email:</p>
                        <br>
                        <input type="number" id="saldoStock" name="saldoStock" class="inputFields" required title="complete este campo">
                        <br>
                        <br>
                    </div>
                    <div class="hijo">
                        <p>Archivo:</p>
                        <br>
                        <input type="file" id="archivo" name="archivo" required title="complete este campo">
                        <br>
                        <br>
                    </div>



                </div>
                <div class="boton">
                    <button class="join-btn " id="button">ENVIAR MODI</button>
                </div>

            </form>

        </div>

    </div>

    <div id="ventanaModalRespuesta" style="display: none;">
        <header class="respuesta">
            <h1>Respuesta del servidor</h1>
            <span class="boton-cerrar">
                <button id="cerrar" class="cerrar">X</button>
            </span>
        </header>

        <div id="contenidoModalRespuesta"></div>

    </div>

    <script src="../jquery.js"></script>
    <script>
        $(document).ready(function() {
            $("#ocultar").on('click', function() {
                $("#contenedor-modal").hide();
                return false;
            });

            $("#mostrar").on('click', function() {
                $("#contenedor-modal").show();
                return false;
            });

            $("#cerrar").on('click', function() {
                $("#ventanaModalRespuesta").hide();
                return false;
            });


        });
    </script>
    <script>
        $(document).ready(function() {

            function mi_funcion() {
                $('#mostrar').attr("disabled", true);

            }


        });
    </script>



    <script>
        $(document).ready(function() {
            $("#cargar-articulos").click(function() {
                cargaTabla();
            });

            $("#limpiar-articulos").click(function() {
                clearTable();
            });

        });
    </script>

    <script>
        function clearTable() {
            $("#tbody-articulos").empty();
        }

        function cargarImagenDni(numeroDocumento) {

            $.ajax({
                type: "get",
                data: {
                    numero_documento: numeroDocumento
                },
                url: "cargar_imagen_dni.php",
                success: function(respuestaDelServer, estado) {

                    objetoDato = JSON.parse(respuestaDelServer);
                    var imagen_frente_data = objetoDato.imagen_frente;
                    $("#ventanaModalRespuesta").css("visibility", "visible");
                    $("#ventanaModalRespuesta").css("display", "block");
                    $("#contenidoModalRespuesta").empty();
                    $("#contenidoModalRespuesta").html("<iframe width='100%' height='600px'src='data:image/jpeg;base64," + imagen_frente_data + "'></iframe>");
                }
            });

        }

        function cargaTabla() {
            $("#tbody-articulos").empty();
            $("#tbody-articulos").html("<p>Esperando respuesta.......</p>");

            varobjAjax = $.ajax({
                type: "get",
                url: "salidaJson.php",

                success: function(respuestaDelServer, estado) {
                    $("#tbody-articulos").empty();
                    objJson = JSON.parse(respuestaDelServer);
                    console.log(objJson);
                    objJson.forEach(function(argValor, argIndice) {

                        var tableRow = document.createElement("tr");

                        var numeroDocTd = document.createElement("td");

                        numeroDocTd.innerHTML = argValor.numero_documento;

                        var tipoDocumentoTd = document.createElement("td");

                        tipoDocumentoTd.innerHTML = argValor.tipo_documento_nombre;

                        var nombreTd = document.createElement("td");

                        nombreTd.innerHTML = argValor.nombre;

                        var apellidosTd = document.createElement("td");

                        apellidosTd.innerHTML = argValor.apellido;

                        var fechaNacTd = document.createElement("td");

                        fechaNacTd.innerHTML = argValor.fecha_nacimiento;

                        var emailTd = document.createElement("td");

                        emailTd.innerHTML = argValor.email;

                        var pdfTd = document.createElement("td");

                        pdfTd.innerHTML = "<button id='mostrar' class='btCelda' onclick='cargarImagenDni(" + argValor.numero_documento + ")'>Arch.Imagen</button>";

                        var modiTd = document.createElement("td");

                        modiTd.innerHTML = "<button onclick=  class='btCelda' >Modi</button>";

                        var borrarTd = document.createElement("td");

                        borrarTd.innerHTML = "<button class='btCelda'>Borrar</button>";




                        tableRow.appendChild(numeroDocTd);
                        tableRow.appendChild(tipoDocumentoTd);
                        tableRow.appendChild(nombreTd);
                        tableRow.appendChild(apellidosTd);
                        tableRow.appendChild(fechaNacTd);
                        tableRow.appendChild(emailTd);
                        tableRow.append(pdfTd);
                        tableRow.append(modiTd);
                        tableRow.append(borrarTd);

                        document.getElementById("tbody-articulos").appendChild(tableRow);
                    }); //

                    $("#totalRegistros").html("Nro de registros: " + objJson.length);
                }
            });

        }
    </script>

</body>

</html>